"use client";
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TextSelectionHandler = TextSelectionHandler;
const react_1 = require("react");
const useTextSelection_1 = require("@/hooks/useTextSelection");
const useNotes_1 = require("@/hooks/useNotes");
const lucide_react_1 = require("lucide-react");
const sonner_1 = require("sonner");
function TextSelectionHandler({ children }) {
    const { getSelectedText, clearSelection } = (0, useTextSelection_1.useTextSelection)();
    const { addToNotes } = (0, useNotes_1.useNotes)();
    const [showContextMenu, setShowContextMenu] = (0, react_1.useState)(false);
    const [contextMenuPosition, setContextMenuPosition] = (0, react_1.useState)({ x: 0, y: 0 });
    const handleAddToNotes = () => {
        const selectedText = getSelectedText();
        if (selectedText) {
            addToNotes(selectedText);
            sonner_1.toast.success("Added to notes!", {
                description: `"${selectedText.substring(0, 50)}${selectedText.length > 50 ? "..." : ""}"`,
                duration: 2000,
            });
            clearSelection();
        }
    };
    const handleContextMenu = (e) => {
        const selectedText = getSelectedText();
        if (selectedText.length > 0) {
            e.preventDefault();
            setContextMenuPosition({ x: e.clientX, y: e.clientY });
            setShowContextMenu(true);
        }
    };
    (0, react_1.useEffect)(() => {
        const handleClickOutside = () => {
            setShowContextMenu(false);
        };
        if (showContextMenu) {
            document.addEventListener("click", handleClickOutside);
            document.addEventListener("contextmenu", handleClickOutside);
        }
        return () => {
            document.removeEventListener("click", handleClickOutside);
            document.removeEventListener("contextmenu", handleClickOutside);
        };
    }, [showContextMenu]);
    return (<div onContextMenu={handleContextMenu}>
      {children}

      {/* Context Menu */}
      {showContextMenu && (<div className="fixed z-50 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-md shadow-lg py-1 animate-in fade-in zoom-in-95 duration-100" style={{
                left: `${contextMenuPosition.x}px`,
                top: `${contextMenuPosition.y}px`,
            }}>
          <button onClick={() => {
                handleAddToNotes();
                setShowContextMenu(false);
            }} className="w-full px-4 py-2 text-sm text-left hover:bg-slate-100 dark:hover:bg-slate-700 flex items-center gap-2 transition-colors">
            <lucide_react_1.StickyNote className="h-4 w-4"/>
            Add to Notes
          </button>
        </div>)}
    </div>);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGV4dFNlbGVjdGlvbkhhbmRsZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJUZXh0U2VsZWN0aW9uSGFuZGxlci50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWSxDQUFDOzs7QUFZYixvREF1RUM7QUFqRkQsaUNBQXVEO0FBQ3ZELCtEQUE0RDtBQUM1RCwrQ0FBNEM7QUFDNUMsK0NBQTBDO0FBQzFDLG1DQUErQjtBQU0vQixTQUFnQixvQkFBb0IsQ0FBQyxFQUFFLFFBQVEsRUFBNkI7SUFDMUUsTUFBTSxFQUFFLGVBQWUsRUFBRSxjQUFjLEVBQUUsR0FBRyxJQUFBLG1DQUFnQixHQUFFLENBQUM7SUFDL0QsTUFBTSxFQUFFLFVBQVUsRUFBRSxHQUFHLElBQUEsbUJBQVEsR0FBRSxDQUFDO0lBQ2xDLE1BQU0sQ0FBQyxlQUFlLEVBQUUsa0JBQWtCLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxDQUFDLENBQUM7SUFDOUQsTUFBTSxDQUFDLG1CQUFtQixFQUFFLHNCQUFzQixDQUFDLEdBQUcsSUFBQSxnQkFBUSxFQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztJQUUvRSxNQUFNLGdCQUFnQixHQUFHLEdBQUcsRUFBRTtRQUM1QixNQUFNLFlBQVksR0FBRyxlQUFlLEVBQUUsQ0FBQztRQUN2QyxJQUFJLFlBQVksRUFBRSxDQUFDO1lBQ2pCLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQztZQUN6QixjQUFLLENBQUMsT0FBTyxDQUFDLGlCQUFpQixFQUFFO2dCQUMvQixXQUFXLEVBQUUsSUFBSSxZQUFZLENBQUMsU0FBUyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsR0FBRyxZQUFZLENBQUMsTUFBTSxHQUFHLEVBQUUsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLEdBQUc7Z0JBQ3pGLFFBQVEsRUFBRSxJQUFJO2FBQ2YsQ0FBQyxDQUFDO1lBQ0gsY0FBYyxFQUFFLENBQUM7UUFDbkIsQ0FBQztJQUNILENBQUMsQ0FBQztJQUVGLE1BQU0saUJBQWlCLEdBQUcsQ0FBQyxDQUFtQixFQUFFLEVBQUU7UUFDaEQsTUFBTSxZQUFZLEdBQUcsZUFBZSxFQUFFLENBQUM7UUFFdkMsSUFBSSxZQUFZLENBQUMsTUFBTSxHQUFHLENBQUMsRUFBRSxDQUFDO1lBQzVCLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztZQUNuQixzQkFBc0IsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUMsT0FBTyxFQUFFLENBQUMsQ0FBQztZQUN2RCxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMzQixDQUFDO0lBQ0gsQ0FBQyxDQUFDO0lBRUYsSUFBQSxpQkFBUyxFQUFDLEdBQUcsRUFBRTtRQUNiLE1BQU0sa0JBQWtCLEdBQUcsR0FBRyxFQUFFO1lBQzlCLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQzVCLENBQUMsQ0FBQztRQUVGLElBQUksZUFBZSxFQUFFLENBQUM7WUFDcEIsUUFBUSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO1lBQ3ZELFFBQVEsQ0FBQyxnQkFBZ0IsQ0FBQyxhQUFhLEVBQUUsa0JBQWtCLENBQUMsQ0FBQztRQUMvRCxDQUFDO1FBRUQsT0FBTyxHQUFHLEVBQUU7WUFDVixRQUFRLENBQUMsbUJBQW1CLENBQUMsT0FBTyxFQUFFLGtCQUFrQixDQUFDLENBQUM7WUFDMUQsUUFBUSxDQUFDLG1CQUFtQixDQUFDLGFBQWEsRUFBRSxrQkFBa0IsQ0FBQyxDQUFDO1FBQ2xFLENBQUMsQ0FBQztJQUNKLENBQUMsRUFBRSxDQUFDLGVBQWUsQ0FBQyxDQUFDLENBQUM7SUFFdEIsT0FBTyxDQUNMLENBQUMsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDLGlCQUFpQixDQUFDLENBQ3BDO01BQUEsQ0FBQyxRQUFRLENBRVQ7O01BQUEsQ0FBQyxrQkFBa0IsQ0FDbkI7TUFBQSxDQUFDLGVBQWUsSUFBSSxDQUNsQixDQUFDLEdBQUcsQ0FDRixTQUFTLENBQUMsMEpBQTBKLENBQ3BLLEtBQUssQ0FBQyxDQUFDO2dCQUNMLElBQUksRUFBRSxHQUFHLG1CQUFtQixDQUFDLENBQUMsSUFBSTtnQkFDbEMsR0FBRyxFQUFFLEdBQUcsbUJBQW1CLENBQUMsQ0FBQyxJQUFJO2FBQ2xDLENBQUMsQ0FFRjtVQUFBLENBQUMsTUFBTSxDQUNMLE9BQU8sQ0FBQyxDQUFDLEdBQUcsRUFBRTtnQkFDWixnQkFBZ0IsRUFBRSxDQUFDO2dCQUNuQixrQkFBa0IsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUM1QixDQUFDLENBQUMsQ0FDRixTQUFTLENBQUMseUhBQXlILENBRW5JO1lBQUEsQ0FBQyx5QkFBVSxDQUFDLFNBQVMsQ0FBQyxTQUFTLEVBQy9COztVQUNGLEVBQUUsTUFBTSxDQUNWO1FBQUEsRUFBRSxHQUFHLENBQUMsQ0FDUCxDQUNIO0lBQUEsRUFBRSxHQUFHLENBQUMsQ0FDUCxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIGNsaWVudFwiO1xuXG5pbXBvcnQgeyBSZWFjdE5vZGUsIHVzZUVmZmVjdCwgdXNlU3RhdGUgfSBmcm9tIFwicmVhY3RcIjtcbmltcG9ydCB7IHVzZVRleHRTZWxlY3Rpb24gfSBmcm9tIFwiQC9ob29rcy91c2VUZXh0U2VsZWN0aW9uXCI7XG5pbXBvcnQgeyB1c2VOb3RlcyB9IGZyb20gXCJAL2hvb2tzL3VzZU5vdGVzXCI7XG5pbXBvcnQgeyBTdGlja3lOb3RlIH0gZnJvbSBcImx1Y2lkZS1yZWFjdFwiO1xuaW1wb3J0IHsgdG9hc3QgfSBmcm9tIFwic29ubmVyXCI7XG5cbmludGVyZmFjZSBUZXh0U2VsZWN0aW9uSGFuZGxlclByb3BzIHtcbiAgY2hpbGRyZW46IFJlYWN0Tm9kZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFRleHRTZWxlY3Rpb25IYW5kbGVyKHsgY2hpbGRyZW4gfTogVGV4dFNlbGVjdGlvbkhhbmRsZXJQcm9wcykge1xuICBjb25zdCB7IGdldFNlbGVjdGVkVGV4dCwgY2xlYXJTZWxlY3Rpb24gfSA9IHVzZVRleHRTZWxlY3Rpb24oKTtcbiAgY29uc3QgeyBhZGRUb05vdGVzIH0gPSB1c2VOb3RlcygpO1xuICBjb25zdCBbc2hvd0NvbnRleHRNZW51LCBzZXRTaG93Q29udGV4dE1lbnVdID0gdXNlU3RhdGUoZmFsc2UpO1xuICBjb25zdCBbY29udGV4dE1lbnVQb3NpdGlvbiwgc2V0Q29udGV4dE1lbnVQb3NpdGlvbl0gPSB1c2VTdGF0ZSh7IHg6IDAsIHk6IDAgfSk7XG5cbiAgY29uc3QgaGFuZGxlQWRkVG9Ob3RlcyA9ICgpID0+IHtcbiAgICBjb25zdCBzZWxlY3RlZFRleHQgPSBnZXRTZWxlY3RlZFRleHQoKTtcbiAgICBpZiAoc2VsZWN0ZWRUZXh0KSB7XG4gICAgICBhZGRUb05vdGVzKHNlbGVjdGVkVGV4dCk7XG4gICAgICB0b2FzdC5zdWNjZXNzKFwiQWRkZWQgdG8gbm90ZXMhXCIsIHtcbiAgICAgICAgZGVzY3JpcHRpb246IGBcIiR7c2VsZWN0ZWRUZXh0LnN1YnN0cmluZygwLCA1MCl9JHtzZWxlY3RlZFRleHQubGVuZ3RoID4gNTAgPyBcIi4uLlwiIDogXCJcIn1cImAsXG4gICAgICAgIGR1cmF0aW9uOiAyMDAwLFxuICAgICAgfSk7XG4gICAgICBjbGVhclNlbGVjdGlvbigpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBoYW5kbGVDb250ZXh0TWVudSA9IChlOiBSZWFjdC5Nb3VzZUV2ZW50KSA9PiB7XG4gICAgY29uc3Qgc2VsZWN0ZWRUZXh0ID0gZ2V0U2VsZWN0ZWRUZXh0KCk7XG5cbiAgICBpZiAoc2VsZWN0ZWRUZXh0Lmxlbmd0aCA+IDApIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHNldENvbnRleHRNZW51UG9zaXRpb24oeyB4OiBlLmNsaWVudFgsIHk6IGUuY2xpZW50WSB9KTtcbiAgICAgIHNldFNob3dDb250ZXh0TWVudSh0cnVlKTtcbiAgICB9XG4gIH07XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCBoYW5kbGVDbGlja091dHNpZGUgPSAoKSA9PiB7XG4gICAgICBzZXRTaG93Q29udGV4dE1lbnUoZmFsc2UpO1xuICAgIH07XG5cbiAgICBpZiAoc2hvd0NvbnRleHRNZW51KSB7XG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQ2xpY2tPdXRzaWRlKTtcbiAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBoYW5kbGVDbGlja091dHNpZGUpO1xuICAgIH1cblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgaGFuZGxlQ2xpY2tPdXRzaWRlKTtcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBoYW5kbGVDbGlja091dHNpZGUpO1xuICAgIH07XG4gIH0sIFtzaG93Q29udGV4dE1lbnVdKTtcblxuICByZXR1cm4gKFxuICAgIDxkaXYgb25Db250ZXh0TWVudT17aGFuZGxlQ29udGV4dE1lbnV9PlxuICAgICAge2NoaWxkcmVufVxuXG4gICAgICB7LyogQ29udGV4dCBNZW51ICovfVxuICAgICAge3Nob3dDb250ZXh0TWVudSAmJiAoXG4gICAgICAgIDxkaXZcbiAgICAgICAgICBjbGFzc05hbWU9XCJmaXhlZCB6LTUwIGJnLXdoaXRlIGRhcms6Ymctc2xhdGUtODAwIGJvcmRlciBib3JkZXItc2xhdGUtMjAwIGRhcms6Ym9yZGVyLXNsYXRlLTcwMCByb3VuZGVkLW1kIHNoYWRvdy1sZyBweS0xIGFuaW1hdGUtaW4gZmFkZS1pbiB6b29tLWluLTk1IGR1cmF0aW9uLTEwMFwiXG4gICAgICAgICAgc3R5bGU9e3tcbiAgICAgICAgICAgIGxlZnQ6IGAke2NvbnRleHRNZW51UG9zaXRpb24ueH1weGAsXG4gICAgICAgICAgICB0b3A6IGAke2NvbnRleHRNZW51UG9zaXRpb24ueX1weGAsXG4gICAgICAgICAgfX1cbiAgICAgICAgPlxuICAgICAgICAgIDxidXR0b25cbiAgICAgICAgICAgIG9uQ2xpY2s9eygpID0+IHtcbiAgICAgICAgICAgICAgaGFuZGxlQWRkVG9Ob3RlcygpO1xuICAgICAgICAgICAgICBzZXRTaG93Q29udGV4dE1lbnUoZmFsc2UpO1xuICAgICAgICAgICAgfX1cbiAgICAgICAgICAgIGNsYXNzTmFtZT1cInctZnVsbCBweC00IHB5LTIgdGV4dC1zbSB0ZXh0LWxlZnQgaG92ZXI6Ymctc2xhdGUtMTAwIGRhcms6aG92ZXI6Ymctc2xhdGUtNzAwIGZsZXggaXRlbXMtY2VudGVyIGdhcC0yIHRyYW5zaXRpb24tY29sb3JzXCJcbiAgICAgICAgICA+XG4gICAgICAgICAgICA8U3RpY2t5Tm90ZSBjbGFzc05hbWU9XCJoLTQgdy00XCIgLz5cbiAgICAgICAgICAgIEFkZCB0byBOb3Rlc1xuICAgICAgICAgIDwvYnV0dG9uPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgPC9kaXY+XG4gICk7XG59XG4iXX0=